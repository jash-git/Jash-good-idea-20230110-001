!function(){var e=function(){};e.prototype={makeTimeline:function(e){return e.zuuvi={altTimeline:[],completed:{},callbacks:{},hasCanPlay:!1},e.origCallback=e.eventCallback,e.origRestart=e.restart,e.origSeek=e.seek,e.origPause=e.pause,e.origPlay=e.play,e.origClear=e.clear,e.playVideo=function(e,t){var n=this;t||0<=t?(this.zuuvi.altTimeline.push({elem:e,action:"play",time:t}),this.zuuvi.hasCanPlay||(this.zuuvi.hasCanPlay=!0,this.pause(),e.readyState>=e.HAVE_FUTURE_DATA?this.restart():e.oncanplay=function(){n.ended||(n.restart(),n.play(),this.oncanplay=null)})):(e.currentTime=0,e.play())},e.pauseVideo=function(e,t){t?this.zuuvi.altTimeline.push({elem:e,action:"pause",time:t}):e.pause()},e.eventCallback=function(e,t,n,i,a){if(e&&t){var s=this.zuuvi.callbacks[e]||{appendCalls:[],masterFun:null,params:null,scope:null};if(a){s.appendCalls.push(t);var r=this.origCallback(e);if(r)return this.zuuvi.callbacks[e]=s,this.origCallback(e,function(){r(),window.setTimeout(function(){t()})},null,s.scope)}else s.masterFun=t,s.params=n,s.scope=i;return this.zuuvi.callbacks[e]=s,this.origCallback(e,function(e){return function(){for(var t=0;t<s.appendCalls.length;t++)s.appendCalls[t].apply(e,[]);s.masterFun&&s.masterFun.apply(this,n)}}(this),null,s.scope)}return e?this.origCallback(e):this.origCallback()},e.restart=function(t,n){e.zuuvi.completed={};for(var i=document.querySelectorAll("video"),a=0;a<i.length;a++)i.item(a).currentTime=0;return t?void 0!==n?this.origRestart(t,n):this.origRestart(t):this.origRestart()},e.pause=function(e){for(var t=this.zuuvi.altTimeline,n=0;n<t.length;n++)t[n].elem.pause();return this.origPause(e)},e.play=function(){var e=this.time(),t=this.zuuvi.altTimeline,n=[];t.sort(function(e,t){return e.time-t.time});for(var i=function(e,t){for(var n=0;n<e.length;n++)if(e[n]&&e[n].elem&&e[n].elem==t)return e[n];return e[n]={elem:t,lastAction:void 0},e[n]},a=0;a<t.length;a++){var s=t[a];if(s.time<=e)i(n,s.elem).lastAction=s.action}for(a=0;a<n.length;a++)"play"!=n[a].lastAction||n[a].elem.ended||n[a].elem.play();return this.origPlay()},e.seek=function(e,t){null==t&&(t=!0);var n=[];this.zuuvi.completed={};var i=this.zuuvi.completed,a=this.zuuvi.altTimeline;a.sort(function(e,t){return e.time-t.time});for(var s=function(e,t){for(var n=0;n<e.length;n++)if(e[n]&&e[n].elem&&e[n].elem==t)return e[n];return e[n]={elem:t,time:0,lastAction:void 0,lastTime:0},e[n]},r=0;r<a.length;r++){var l=a[r];if(l.time<=e){i[r]=!0;var o=s(n,l.elem);"play"==o.lastAction&&"pause"==l.action&&(o.time+=l.time-o.lastTime),o.lastTime=l.time,o.lastAction=l.action}}for(var u=0;u<n.length;u++){var c=n[u];"play"==c.lastAction&&(c.time+=e-c.lastTime),c.elem.currentTime=c.time,"play"==c.lastAction&&this.isActive()?c.elem.play():c.elem.pause()}return this.origSeek(e,t)},e.clear=function(){for(var e=this.zuuvi.altTimeline,t=0;t<e.length;t++)e[t].elem.pause(),e[t].elem.time=0;return this.zuuvi.altTimeline=[],this.origClear()},e.eventCallback("onUpdate",function(){for(var t=e.time(),n=this.zuuvi.altTimeline,i=this.zuuvi.completed,a=0;a<n.length;a++)!i[a]&&n[a].time<=t&&(i[a]=!0,"play"==n[a].action?n[a].elem.play():n[a].elem.pause())},null,null,!0),e.eventCallback("onRepeat",function(){e.zuuvi.completed={};for(var t=document.querySelectorAll("video"),n=0;n<t.length;n++){var i=t.item(n);i.currentTime=0,i.pause()}},null,null,!0),e},loadAndPlayVideo:function(e){e.load(),e.addEventListener("canplay",function(){this.play()})},autoFontSize:function(e,t){var n=parseInt(t.parentNode.style.height)||parseInt(t.parentNode.style.maxHeight)||1/0,i=parseInt(t.parentNode.style.width)||parseInt(t.parentNode.style.maxWidth)||1/0,a=parseInt(window.getComputedStyle(e).getPropertyValue("font-size"));t.style.fontSize=a+"px";for(var s=Math.max(t.offsetHeight,t.scrollHeight)-(parseInt(t.style.marginTop)||0),r=Math.max(t.offsetWidth,t.scrollWidth)-(parseInt(t.style.marginLeft)||0);(s>n||r>i)&&!(a<=8);)a--,t.style.fontSize=a+"px",s=Math.max(t.offsetHeight,t.scrollHeight)-(parseInt(t.style.marginTop)||0),r=Math.max(t.offsetWidth,t.scrollWidth)-(parseInt(t.style.marginLeft)||0)},elementChangeFuns:{},onChangeListener:function(e,t){if("function"!=typeof t)throw TypeError("Listener must be a function");this.elementChangeFuns[e.id]=t},elementChanged:function(e){this.elementChangeFuns[e.id]&&this.elementChangeFuns[e.id]()},elm:null,elmIdStr:null,sessID:null,id:null,uid:null,hasInteracted:!1,isIframe:!1,hasBeenViewed:!1,host:null,trackedEvents:[],registeredEvents:[],eventsBeeingPushed:[],lastMouseEnter:null,mouseEnterWatcher:null,eventURL:null,myUID:null,state:0,isPushing:!1,pushCBs:[],interactionCBs:[],addEventListener:function(e,t,n){e.addEventListener?e.addEventListener(t,n):e.attachEvent("on"+t,function(){n.call(e)})},ready:function(e){"loading"!=document.readyState?e():document.addEventListener?document.addEventListener("DOMContentLoaded",e):document.attachEvent("onreadystatechange",function(){"loading"!=document.readyState&&e()})},post:function(e,t,n,i){var a=new XMLHttpRequest;a.open("POST",e,!0),a.setRequestHeader("Content-Type","application/json;charset=UTF-8"),a.onreadystatechange=function(e){4===a.readyState&&(200===a.status?"function"==typeof n&&n(a):"function"==typeof i&&i(a))},a.send(JSON.stringify(t))},initTracking:function(){var e=this;this.ready(function(){e.elm=document.getElementById(e.elmIdStr),e.addEventListener(e.elm,"click",function(){e.registerClick()}),e.addEventListener(e.elm,"mouseenter",function(){e.mouseEnterWatcher=setTimeout(function(){e.lastMouseEnter=new Date,e.registerHover()},1e3)}),e.addEventListener(e.elm,"mouseleave",function(){e.mouseEnterWatcher&&(e.lastMouseEnter=null,clearTimeout(e.mouseEnterWatcher))}),setInterval(function(){e.push()},5e3)})},doInteraction:function(e){if(!this.hasInteracted){this.track("interaction","true"),this.hasInteracted=!0,e&&this.push();for(var t=0;t<this.interactionCBs.length;t++)this.interactionCBs[t]()}},doClickThrough:function(){if(0==this.state){var e=this;this.isPushing?this.pushCBs.push(function(){t()}):t()}function t(){e.doInteraction(!1),e.track("click-through","true"),e.state=2;for(var t=JSON.parse(JSON.stringify(e.registeredEvents.concat(e.trackedEvents))),n=0;n<t.length;n++)t[n].state=1;e.trackedEvents=e.trackedEvents.concat(t),e.push(!0)}},track:function(e,t,n,i){this.trackedEvents.push({category:e,action:t,label:n,value:i,state:this.state})},push:function(e){var t=this;if(t.isPushing&&e&&t.pushCBs.push(function(){t.push()}),null!=t.eventURL&&(t.isPushing=!0,t.eventsBeeingPushed=t.trackedEvents,t.trackedEvents=[],t.eventsBeeingPushed.length))try{t.post(t.eventURL,{uid:t.uid,id:t.id,events:t.eventsBeeingPushed},function(e){try{var n=JSON.parse(e.responseText);if(!n.status)throw"Invalid response";t.uid=n.uid,t.registeredEvents=t.registeredEvents.concat(t.eventsBeeingPushed),t.isPushing=!1;for(var i=0;i<t.pushCBs.length;i++)t.pushCBs[i]();t.pushCBs=[]}catch(e){t.trackedEvents=t.eventsBeeingPushed.concat(t.trackedEvents),t.isPushing=!1}},function(e){t.trackedEvents=t.eventsBeeingPushed.concat(t.trackedEvents),t.isPushing=!1})}catch(e){t.trackedEvents=t.eventsBeeingPushed.concat(t.trackedEvents),t.isPushing=!1}},registerClick:function(){this.doInteraction()},registerHover:function(){this.doInteraction()},onView:function(e){dhtml&&dhtml.sharedEvents.once("view",e)},onPageLoad:function(e){dhtml&&dhtml.sharedEvents.once("pageLoadComplete",e)},onInteraction:function(e){this.interactionCBs.push(e)},initPoliteMode:function(){dhtml&&dhtml.external.initPoliteMode()},registerTracking:function(e,t,n){this.id=e,this.elmIdStr=t,this.initTracking(),this.eventURL=n}},window._zuuvi=new e}();